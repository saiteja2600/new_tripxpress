<!DOCTYPE html>
{% load static %}

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TripXpress - Go Places, Fast. Easy</title>
   <!-- Google Font: Source Sans Pro -->
   <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
   <!-- Font Awesome -->
   <link rel="stylesheet" href="{% static 'assets/plugins/fontawesome-free/css/all.min.css' %}">
   <!-- Ionicons -->
   <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
   <!-- Tempusdominus Bootstrap 4 -->
   <link rel="stylesheet" href="{% static 'assets/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css' %}">
   <!-- iCheck -->
   <link rel="stylesheet" href="{% static 'assets/plugins/icheck-bootstrap/icheck-bootstrap.min.css' %}">
   <!-- JQVMap -->
   <link rel="stylesheet" href="{% static 'assets/plugins/jqvmap/jqvmap.min.css' %}">
   <!-- Theme style -->
   <link rel="stylesheet" href="{% static 'assets/dist/css/adminlte.min.css' %}">
   <!-- overlayScrollbars -->
   <link rel="stylesheet" href="{% static 'assets/plugins/overlayScrollbars/css/OverlayScrollbars.min.css' %}">
   <!-- Daterange picker -->
   <link rel="stylesheet" href="{% static 'assets/plugins/daterangepicker/daterangepicker.css' %}">
   <!-- summernote -->
   <link rel="stylesheet" href="{% static 'assets/plugins/summernote/summernote-bs4.min.css' %}">
 
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.22.0/dist/sweetalert2.min.css">
 
   
 <link rel="stylesheet" href="{% static 'assets/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css' %}">
 <link rel="stylesheet" href="{% static 'assets/plugins/datatables-responsive/css/responsive.bootstrap4.min.css' %}">
 <link rel="stylesheet" href="{% static 'assets/plugins/datatables-buttons/css/buttons.bootstrap4.min.css' %}">
 
   {% comment %} Icon {% endcomment %}
     <link rel="shortcut icon" href="{% static 'favicon/favicon.ico' %}" type="image/x-icon">
     <link rel="stylesheet" href="{% static 'styles/admin_css/register.css' %}">
</head>


  <body class="hold-transition register-page register-profile">
    <div class="container h-100 d-flex align-items-center justify-content-center">
      <div class="row w-100">
       <div class="col-12 col-md-6 d-flex align-items-center justify-content-center text-white text-center flex-column">
        <div class="branding-content px-3">
          <img src="{% static 'images/ticket_logo.png' %}" alt="Logo" style="width: 80px;">
          <h1 class="mt-3 display-4 d-none d-md-block">Welcome to <span class="brand-text">Trip<span class="highlight">Xpress</span></span></h1>
          <h2 class="mt-3 h4 d-block d-md-none">Welcome to <span class="brand-text">Trip<span class="highlight">Xpress</span></span></h2>
          <p class="lead d-none d-md-block">Fast. Easy. Reliable Travel Booking.</p>
          <p class="small d-block d-md-none">Fast. Easy. Reliable Travel Booking.</p>
        </div>
      </div>

        <!-- Right Form Column -->
        <div class="col-md-6">
          <div class="card glass-card p-4">
            <div class="text-center mb-4">
              <h3 class="text-white">Create Your Account</h3>
            </div>
            <form method="post" action="" id="register-form">
              {% csrf_token %}
              <div class="row">
                <div class="col-md-6 mb-3">
                  <div class="form-group mb-3">
                    <input type="text" name="first_name" class="form-control" placeholder="Full name">
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <div class="form-group mb-3">
                    <input type="text" name="last_name" class="form-control" placeholder="Last name">
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <div class="form-group mb-3">
                    <input type="email" name="email" class="form-control" placeholder="Email">
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <div class="form-group mb-3">
                    <input type="text" name="phone_number" class="form-control" placeholder="Phone">

                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <div class="form-group">
                    
                    <select id="country" name="country" class="form-control">
                      <option value="">Select Country</option>
                      {% for c in country %}
                        <option value="{{ c.id }}">{{ c.name }}</option>
                      {% endfor %}
                    </select>
                  </div>
                </div>
                
                <div class="col-md-6 mb-3">
                  <div class="form-group">
                    
                    <select id="state" name="state" class="form-control">
                      <option value="">Select State</option>
                    </select>
                  </div>
                </div>
                
                <div class="col-md-6 mb-3">
                  <div class="form-group">
                    
                    <select id="city" name="city" class="form-control">
                      <option value="">Select City</option>
                    </select>
                  </div>
                </div>
                
                <div class="col-md-6 mb-3">
                  <div class="form-group mb-3">
                    <select name="branch" id="branch" class="form-control">
                      <option value="">Select Branch</option>
                    </select>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <div class="form-group mb-3">
                    <input type="password" name="password" class="form-control" placeholder="Password">
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <div class="form-group mb-3">
                    <input type="password" name="confirm_password" class="form-control" placeholder="Retype Password">
                  </div>
                </div>
              </div>
              <div class="form-group mb-3">
                <div class="icheck-primary">
                  <input type="checkbox" id="agreeTerms" name="is_active" value="agree">
                  <label for="agreeTerms" class="text-white">
                    I agree to the <a href="#">terms</a>
                  </label>
                </div>
              </div>
              <div class="form-group">
                <button type="submit" class="btn btn-warning btn-block">Register</button>
              </div>
            </form>
            <p class="text-center mt-3">
              <a href="login.html" class="text-light">Already have an account? Sign in</a>
            </p>
          </div>
        </div>
      </div>
    </div>
  
  
    <script src="{% static 'assets/plugins/jquery/jquery.min.js' %}"></script>

    <!-- jQuery UI -->
    <script src="{% static 'assets/plugins/jquery-ui/jquery-ui.min.js' %}"></script>
    <script>
      $.widget.bridge('uibutton', $.ui.button);
    </script>
    
    <!-- Bootstrap -->
    <script src="{% static 'assets/plugins/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    
    <!-- jQuery Validation -->
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.3/dist/jquery.validate.min.js"></script>
    
    <!-- SweetAlert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.22.0/dist/sweetalert2.all.min.js"></script>
    
    <!-- DataTables -->
    <script src="{% static 'assets/plugins/datatables/jquery.dataTables.min.js' %}"></script>
    <script src="{% static 'assets/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js' %}"></script>
    <script src="{% static 'assets/plugins/datatables-responsive/js/dataTables.responsive.min.js' %}"></script>
    <script src="{% static 'assets/plugins/datatables-responsive/js/responsive.bootstrap4.min.js' %}"></script>
    <script src="{% static 'assets/plugins/datatables-buttons/js/dataTables.buttons.min.js' %}"></script>
    <script src="{% static 'assets/plugins/datatables-buttons/js/buttons.bootstrap4.min.js' %}"></script>
    <script src="{% static 'assets/plugins/jszip/jszip.min.js' %}"></script>
    <script src="{% static 'assets/plugins/pdfmake/pdfmake.min.js' %}"></script>
    <script src="{% static 'assets/plugins/pdfmake/vfs_fonts.js' %}"></script>
    <script src="{% static 'assets/plugins/datatables-buttons/js/buttons.html5.min.js' %}"></script>
    <script src="{% static 'assets/plugins/datatables-buttons/js/buttons.print.min.js' %}"></script>
    <script src="{% static 'assets/plugins/datatables-buttons/js/buttons.colVis.min.js' %}"></script>
    
    <!-- AdminLTE -->
    <script src="{% static 'assets/dist/js/adminlte.js' %}"></script>
    
    <!-- Other Plugins (if used) -->
    <script src="{% static 'assets/plugins/chart.js/Chart.min.js' %}"></script>
    <script src="{% static 'assets/plugins/sparklines/sparkline.js' %}"></script>
    <script src="{% static 'assets/plugins/jqvmap/jquery.vmap.min.js' %}"></script>
    <script src="{% static 'assets/plugins/jqvmap/maps/jquery.vmap.usa.js' %}"></script>
    <script src="{% static 'assets/plugins/jquery-knob/jquery.knob.min.js' %}"></script>
    <script src="{% static 'assets/plugins/moment/moment.min.js' %}"></script>
    <script src="{% static 'assets/plugins/daterangepicker/daterangepicker.js' %}"></script>
    <script src="{% static 'assets/plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js' %}"></script>
    <script src="{% static 'assets/plugins/summernote/summernote-bs4.min.js' %}"></script>
    <script src="{% static 'assets/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js' %}"></script>
   <script> 
    $('#register-form').validate({
      rules: {
        first_name: { required: true },
        last_name: { required: true },
        email: { required: true, email: true },
        phone_number: { required: true },
        country: { required: true },
        state: { required: true },
        city: { required: true },
        branch: { required: true },
        password: { required: true },
        confirm_password: {
          required: true,
          equalTo: '[name="password"]'
        },
        is_active: {
          required: true
        }
      },
      messages: {
        first_name: { required: 'Enter First Name' },
        last_name: { required: 'Enter Last Name' },
        email: {
          required: 'Enter Email',
          email: 'Enter a valid Email'
        },
        phone_number: { required: 'Enter Phone' },
        country: { required: 'Select Country' },
        state: { required: 'Select State' },
        city: { required: 'Select City' },
        branch: { required: 'Select Branch' },
        password: { required: 'Enter Password' },
        confirm_password: {
          required: 'Retype Password',
          equalTo: 'Passwords do not match'
        },
        is_active: {
          required: 'You must agree to the terms'
        }
      },
      errorElement: 'span',
      errorClass: 'text-danger',
      highlight: function (element) {
        $(element).addClass('is-invalid');
      },
      unhighlight: function (element) {
        $(element).removeClass('is-invalid');
      },
      errorPlacement: function (error, element) {
        if (element.attr("name") === "is_active") {
          // Place error after the checkbox's label container
          error.insertAfter(element.closest('.icheck-primary'));
        } else {
          error.insertAfter(element);
        }
      }
    });
  </script>    

  <script>
    const loadStatesUrl = "{% url 'get_states' %}";
    const loadCitiesUrl = "{% url 'get_cities' %}";
    const loadBranchesUrl = "{% url 'get_branches' %}";
  
    $(document).ready(function () {
      // Load states when a country is selected
      $("#country").change(function () {
        const countryId = $(this).val();
        if (!countryId) {
          $("#state").html('<option value="">Select State</option>');
          $("#city").html('<option value="">Select City</option>');
          $("#branch").html('<option value="">Select Branch</option>');
          return;
        }
  
        $.ajax({
          url: loadStatesUrl,
          data: { country_id: countryId },
          success: function (data) {
            $("#state").html('<option value="">Select State</option>');
            $("#city").html('<option value="">Select City</option>');
            $("#branch").html('<option value="">Select Branch</option>');
            data.forEach(function (state) {
              $("#state").append('<option value="' + state.id + '">' + state.name + '</option>');
            });
          }
        });
      });
  
      // Load cities when a state is selected
      $("#state").change(function () {
        const stateId = $(this).val();
        if (!stateId) {
          $("#city").html('<option value="">Select City</option>');
          $("#branch").html('<option value="">Select Branch</option>');
          return;
        }
  
        $.ajax({
          url: loadCitiesUrl,
          data: { state_id: stateId },
          success: function (data) {
            $("#city").html('<option value="">Select City</option>');
            $("#branch").html('<option value="">Select Branch</option>');
            data.forEach(function (city) {
              $("#city").append('<option value="' + city.id + '">' + city.name + '</option>');
            });
          }
        });
      });
  
      // Load branches when a city is selected
      $("#city").change(function () {
        const cityId = $(this).val();
        if (!cityId) {
          $("#branch").html('<option value="">Select Branch</option>');
          return;
        }
  
        $.ajax({
          url: loadBranchesUrl,
          data: { city_id: cityId },
          success: function (data) {
            $("#branch").html('<option value="">Select Branch</option>');
            data.forEach(function (branch) {
              $("#branch").append('<option value="' + branch.id + '">' + branch.name + '</option>');
            });
          }
        });
      });
    });
  </script>
  
  {% if messages %}
  <script>
    {% for message in messages %}
      Swal.fire({
        toast: true,
        positionclass: 'toast-top-end',
        position: 'top-end',

        icon: '{% if message.tags == "success" %}success{% elif message.tags == "error" %}error{% else %}info{% endif %}',
        title: '{{ message }}',
        showConfirmButton: false,
        timer: 3000,
        timerProgressBar: true,
        didOpen: (toast) => {
          toast.addEventListener('mouseenter', Swal.stopTimer)
          toast.addEventListener('mouseleave', Swal.resumeTimer)
        }
      });
    {% endfor %}
  </script>
  {% endif %}
  
</body>
</html>